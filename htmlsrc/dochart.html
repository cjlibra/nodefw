<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>流水线管理系统</title>
	<link rel="shortcut icon" href="./favicon.ico">
   <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,700">  -->
	<link rel="stylesheet" href="./jmobile/demos/css/themes/default/jquery.mobile-1.4.5.min.css">
	<link rel="stylesheet" href="./jmobile/demos/_assets/css/jqm-demos.css">
	 <link rel="stylesheet" href="./jmobile/jquery-mobile-datepicker-wrapper-master/jquery.mobile.datepicker.css" />
	<script src="./js/jquery-1.11.2.min.js"></script>
	<script src="./jmobile/demos/_assets/js/index.js"></script>
	<script src="./js/jquery.mobile-1.4.5.min.js"></script>
 <script src="./jmobile/jquery-mobile-datepicker-wrapper-master/external/jquery-ui/datepicker.js"></script>
  
  <script src="./jmobile/jquery-mobile-datepicker-wrapper-master/jquery.mobile.datepicker.js"></script>
	
	
	<script type="text/javascript">
	    var linestrorig = '<li>  <div class="ui-grid-a"> \
		                <div class="ui-block-a">   \
						<p>$num$</p>  \
					</div>   \
					<div class="ui-block-b">  \
						<p>$workshop$</p>   \
					</div>   \
					<div class="ui-block-c">  \
						<p>$worktype$</p>  \
					</div>   \
					<div class="ui-block-d"  style = "background-color: $collor$ ">  \
						<p>$action$</p>  \
					</div>  \
				</div>  \
		  </li>'  ;
		   var liststrs="";
		 function GetJsonLT(){
		 
		     $("#sel2").empty(); 
			 
			  
		
			 
  
			 var option = $("<option>").val(0).text("--请选择制程--");
			 $("#sel2").append(option);
			 $("#sel2").selectmenu("refresh",true);
	
			 $.getJSON("/info_getlt",null,function(data){ 
               
		        $.each(data,function(idx,item){ 
					//if(idx==0){ 
					//	 return true;//同countinue，返回false同break 
					//} 
                   
				    

                option = $("<option>").val(idx+1).text(item.Linetype);
				//alert(item.Linetype+idx);

                $("#sel2").append(option);
				   
		        }); 
				 
					   
		    }); 
			
		 
		 };
	    function GetJsonWS(){
		    $("#sel2").empty();  
			var option = $("<option>").val(-1).text("--请选择车间--");
			$("#sel2").append(option);
		    $("#sel2").val(-1).attr("selected", true); ;
			$("#sel2 :selected").text("--请选择车间--");
			 
			$("#sel2").selectmenu("refresh",true);
			$.getJSON("/info_getws",null,function(data){ 
               
		        $.each(data,function(idx,item){ 
					//if(idx==0){ 
					//	 return true;//同countinue，返回false同break 
					//} 
                   
				    

                option = $("<option>").val(idx+1).text(item.WorkShop);
				//alert(item.WorkShop+idx);

                $("#sel2").append(option);
				   
		        }); 
				 
				 
		    }); 
			
			

        }
		
		function GetJsonSidByWS(){
		    $("#sel3").empty();
			var selectedvalue = $("#sel2  :selected").text(); 
			option = $("<option>").val(0).text("--请选择站点--");			
            $("#sel3").append(option);
			$("#sel3").selectmenu("refresh",true);
			
		    $.getJSON("/sidbyworkshop?workshop="+selectedvalue,null,function(data){ 
               
		        $.each(data,function(idx,item){ 
					

                option = $("<option>").val(idx+1).text(item.Sid);
				//alert(item.WorkShop+idx);

                $("#sel3").append(option);
				   
		        }); 
				 
				 
		    }); 
		
		}
		function GetJsonSidByLT(){
		    $("#sel3").empty();
			var selectedvalue = $("#sel2  :selected").text(); 
			option = $("<option>").val(0).text("--请选择站点--");			
            $("#sel3").append(option);
			$("#sel3").selectmenu("refresh",true);
		    $.getJSON("/sidbylinetype?linetype="+selectedvalue,null,function(data){ 
               
		        $.each(data,function(idx,item){ 
					

                option = $("<option>").val(idx+1).text(item.Sid);
				//alert(item.WorkShop+idx);

                $("#sel3").append(option);
				   
		        }); 
				 
				 
		    }); 
		
		}
		
		function  GetJsonInfoBySid(){
		    selectedvalue = $("#sel3 :selected").text();
			
		    $.getJSON("/infoloaderbylineid?lineid="+selectedvalue+"&&loader=1" ,null,function(data){ 
               	        
				    clearparm();
					$("#workshop").text(data.Workshop);
					$("#linetype").text(data.LineType);
					$("#MachineID").text(data.MachineID);
					$("#MachineName").text(data.MachineName);
					$("#MachineType").text(data.MachineType);
					$("#TotalOutput").text(data.TotalOutput);
					$("#CurOutput").text(data.CurOutput);
					$("#CurTotalOutput").text(data.CurTotalOutput);
					$("#CurPartNum").text(data.CurPartNum);
					$("#CurBatchNum").text(data.CurBatchNum);
					$("#UpdateTime").text(data.UpdateTime);
					$("#LoaderStatus").text(data.LoaderStatus);
					
				 
		    }); 
			
			 $.getJSON("/infoloaderbylineid?lineid="+selectedvalue+"&&loader=0" ,null,function(data){ 
               	        
				     
					//$("#workshop").text(data.Workshop);
					//$("#linetype").text(data.LineType);
					$("#MachineID1").text(data.MachineID);
					$("#MachineName1").text(data.MachineName);
					$("#MachineType1").text(data.MachineType);
					$("#TotalOutput1").text(data.TotalOutput);
					$("#CurOutput1").text(data.CurOutput);
					$("#CurTotalOutput1").text(data.CurTotalOutput);
					$("#CurPartNum1").text(data.CurPartNum);
					$("#CurBatchNum1").text(data.CurBatchNum);
					$("#UpdateTime1").text(data.UpdateTime);
					$("#UnloaderStatus1").text(data.UnloaderStatus);
					
				 
		    }); 
		
		
		}
		function clearparm(){
		
		            $("#workshop").text("");
					$("#linetype").text("");
					$("#MachineID").text("");
					$("#MachineName").text("");
					$("#MachineType").text("");
					$("#TotalOutput").text("");
					$("#CurOutput").text("");
					$("#CurTotalOutput").text("");
					$("#CurPartNum").text("");
					$("#CurBatchNum").text("");
					$("#UpdateTime").text("");
					$("#LoaderStatus").text("");
		            $("#MachineID1").text("");
					$("#MachineName1").text("");
					$("#MachineType1").text("");
					$("#TotalOutput1").text("");
					$("#CurOutput1").text("");
					$("#CurTotalOutput1").text("");
					$("#CurPartNum1").text("");
					$("#CurBatchNum1").text("");
					$("#UpdateTime1").text("");
					$("#UnloaderStatus1").text("");
					
		
		
		}
		
		 
		
		$(document).ready(function(){ 
		 
        $("#sel2").empty();
		$("#sel3").empty();
		clearparm();
		$("#sel1").change(function(){
		
		       
		       var sel1value = $("#sel1").val();
			  
			   if (sel1value == "1")
			   {
			  
			      GetJsonWS();
			      
			   }
			   else
			   {
			    
			      GetJsonLT();
				 
			   }
		
		
		});
		
		$("#sel2").change(function(){
		     var sel2value = $('#sel2 option:first').val();
			
			 if (sel2value == -1)
			 {
			    
			    GetJsonSidByWS();
			 }
			 else
			 {
			 
			     GetJsonSidByLT();
			 
			 }
		
		
		});
		
		$("#sel3").change(function(){
		     
		       GetJsonInfoBySid();
		
		});
		});
	  
	  </script>
</head>
<body>
<div data-role="page" class="jqm-demos" data-quicklinks="true">

	<div data-role="header" data-position="fixed" >
	 <h1>流水线管理系统</h1>
	 <div data-role="navbar">
	    <ul>
		<li><a rel="external" href="/src/index.html" >设备状态</a></li>
		<li><a rel="external" href="/src/devinfo.html" >设备详情</a></li>
		<li><a rel="external" href="/src/dochart.html" >统计图表</a></li>
		<li><a  rel="external" href="/src/alarms.html" >活动告警</a></li>
		</ul>
	 </div>
	</div><!-- /header -->

	<div data-role="content"  >
	   <ul data-role="listview"  id="listview">
	      <li data-role="list-divider"> 筛选
		  
		 <li> <div class="ui-grid-a">
		 <select   id="sel1">
	<option selected="selected" value="0" >--请选择查询方式--</option>
	<option  value="1">按车间查询</option>
	<option value="2">按制程查询</option>

</select>
 <select    id="sel2">
	<option selected="selected" value="0">--请选择车间--</option>
	<option value="1">{第01号车间</option>
	<option value="2">{第03号车间</option>
	<option value="3">{第07号车间</option>
	<option value="4">{第15号车间</option>

</select>


                 <select   id="sel3">
	<option selected="selected" value="0">--请选择站号--</option>
	<option value="1">{21</option>
	<option value="2">{22</option>
	<option value="3">{23</option>
	<option value="4">{24</option>
	<option value="5">{25</option>
	<option value="6">{26</option>
         </select>
		 </div>
		 <li data-role="list-divider">统计定义
		 <li><form>
    <fieldset data-role="controlgroup"   >
        <legend>统计类型：</legend>
        <input type="radio" name="radio-choice-h-a2" id="radio-choice-h-a2a" value="on" checked="checked">
        <label for="radio-choice-h-a2a">日报</label>
        <input type="radio" name="radio-choice-h-a2" id="radio-choice-h-a2b" value="off">
        <label for="radio-choice-h-a2b">月报</label>
        <input type="radio" name="radio-choice-h-a2" id="radio-choice-h-a2c" value="other">
        <label for="radio-choice-h-a2c">自定义(1)</label>
        <input type="radio" name="radio-choice-h-a2" id="radio-choice-h-a2d" value="other">
        <label for="radio-choice-h-a2d">自定义(2)</label>
    </fieldset>
</form></li>

		<li> <form>
    <fieldset data-role="controlgroup" >
        <legend>时间单位：</legend>
        <input type="radio" name="radio-choice-h-2" id="radio-choice-h-2a" value="on" checked="checked">
        <label for="radio-choice-h-2a">小时</label>
        <input type="radio" name="radio-choice-h-2" id="radio-choice-h-2b" value="off">
        <label for="radio-choice-h-2b">日</label> 
        <input type="radio" name="radio-choice-h-2" id="radio-choice-h-2c" value="other">
        <label for="radio-choice-h-2c">班</label>
    </fieldset>
     </form> </li>
	 
				 <li>  				 
						<legend>统计日期：</legend>
				 
					 
				      <!--  <input type="text" id="date-input" data-inline="false" data-role="date">  -->
					  <input type="date" />
                         
					 
					 
				 </li>
		<li> 	<legend>统计天数：</legend>
				 
					 
					    <select>
						   <option selected="selected" value="--天--">--天--</option>
						</select>

					 
					 
				 </li>
		 <li data-role="list-divider">统计分析
		 <li> <div class="ui-grid-a">
					<div class="ui-block-a">
						<p>稼动率：</p>
					</div> 
					<div class="ui-block-b">
						<p id="MachineName">{54%</p>
					</div> 
					 
				</div></li>
		<li> <div class="ui-grid-a">
					<div class="ui-block-a">
						<p>平均产能：</p>
					</div> 
					<div class="ui-block-b">
						<p id="MachineType">{5000</p>
					</div> 
					 
				</div></li>
		<li> <div class="ui-grid-a">
					<div class="ui-block-a">
						<p>产量偏差：</p>
					</div> 
					<div class="ui-block-b">
						<p id="MachineID">{3</p>
					</div> 
					 
				</div></li>
		<li> <div class="ui-grid-a">
					<div class="ui-block-a">
						<p>进度偏差：</p>
					</div> 
					<div class="ui-block-b">
						<p id="LoaderStatus">{3456</p>
					</div> 
					 
				</div></li>
		
		
				
		<li data-role="list-divider">统计饼图</li>
		 <div id="main0" style="height:400px"></div>
    <!-- ECharts单文件引入 -->
    <script src="./jmobile/echarts-2.2.1/build/dist/echarts.js"></script>
    <script type="text/javascript">
        // 路径配置
        require.config({
            paths: {
                echarts: './jmobile/echarts-2.2.1/build/dist'
            }
        });
        
        // 使用
        require(
            [
                'echarts',
                'echarts/chart/pie' // 使用柱状图就加载bar模块，按需加载
            ],
            function (ec) {
                // 基于准备好的dom，初始化echarts图表
                var myChart = ec.init(document.getElementById('main0')); 
                
              var option = {
						title : {
							text: '某站点用户访问来源',
							subtext: '纯属虚构',
							x:'center'
						},
						tooltip : {
							trigger: 'item',
							formatter: "{a} <br/>{b} : {c} ({d}%)"
						},
						legend: {
							orient : 'vertical',
							x : 'left',
							data:['直接访问','邮件营销','联盟广告','视频广告','搜索引擎']
						},
						/*toolbox: {
							show : true,
							feature : {
								mark : {show: true},
								dataView : {show: true, readOnly: false},
								magicType : {
									show: true, 
									type: ['pie', 'funnel'],
									option: {
										funnel: {
											x: '25%',
											width: '50%',
											funnelAlign: 'left',
											max: 1548
										}
									}
								},
								restore : {show: true},
								saveAsImage : {show: true}
							}
						},*/
						calculable : true,
						series : [
							{
								name:'访问来源',
								type:'pie',
								radius : '55%',
								center: ['50%', '60%'],
								data:[
									{value:335, name:'直接访问'},
									{value:310, name:'邮件营销'},
									{value:234, name:'联盟广告'},
									{value:135, name:'视频广告'},
									{value:1548, name:'搜索引擎'}
								]
							}
						]
					};
        
                // 为echarts对象加载数据 
                myChart.setOption(option); 
            }
        );
    </script>
		 
		 
		 <li data-role="list-divider">产量走势图</li>
		  <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main1" style="height:400px"></div>
    <!-- ECharts单文件引入 -->
    <script src="./jmobile/echarts-2.2.1/build/dist/echarts.js"></script>
    <script type="text/javascript">
        // 路径配置
        require.config({
            paths: {
                echarts: './jmobile/echarts-2.2.1/build/dist'
            }
        });
        
        // 使用
        require(
            [
                'echarts',
				 'echarts/chart/line' ,
                'echarts/chart/bar' // 使用柱状图就加载bar模块，按需加载
            ],
            function (ec) {
                // 基于准备好的dom，初始化echarts图表
                var myChart = ec.init(document.getElementById('main1')); 
                
                var option = {
                    tooltip: {
                        show: true
                    },
                    legend: {
                        data:['销量','销量1']
                    },
                    xAxis : [
                        {
                            type : 'category',
                            data : ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]
                        }
                    ],
                    yAxis : [
                        {
                            type : 'value'
                        }
                    ],
                    series : [
                        {
                            "name":"销量",
                            "type":"bar",
                            "data":[5, 20, 40, 10, 10, 20]
                        },
						 {
                            "name":"销量1",
                            "type":"line",
                            "data":[15, 30, 30, 10, 20, 20]
                        }
                    ]
                };
        
                // 为echarts对象加载数据 
                myChart.setOption(option); 
            }
        );
    </script>
		 
		 <li data-role="list-divider">单位产量图</li>
		  <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main2" style="height:400px"></div>
    <!-- ECharts单文件引入 -->
   
    <script type="text/javascript">
        
         // 路径配置
        require.config({
            paths: {
                echarts: './jmobile/echarts-2.2.1/build/dist'
            }
        });
        // 使用
        require(
            [
                'echarts',
                'echarts/chart/bar' // 使用柱状图就加载bar模块，按需加载
            ],
            function (ec) {
                // 基于准备好的dom，初始化echarts图表
                var myChart = ec.init(document.getElementById('main2')); 
                
                var option = {
                    tooltip: {
                        show: true
                    },
                    legend: {
                        data:['销量']
                    },
                    xAxis : [
                        {
                            type : 'category',
                            data : ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]
                        }
                    ],
                    yAxis : [
                        {
                            type : 'value'
                        }
                    ],
                    series : [
                        {
                            "name":"销量",
                            "type":"bar",
                            "data":[1, 30, 50, 20, 20, 30]
                        }
                    ]
                };
        
                // 为echarts对象加载数据 
                myChart.setOption(option); 
            }
        );
		
		 
	    </script>
	   </ul>
	</div> 
	<div data-role="footer"  >
	   <div data-role="navbar">
	    <ul>
		<li><a rel="external" href="/src/index.html" >设备状态</a></li>
		<li><a rel="external" href="/src/devinfo.html" >设备详情</a></li>
		<li><a href="#index" >统计图表</a></li>
		<li><a  rel="external" href="/src/alarms.html" >活动告警</a></li>
		</ul>
	 </div>
	</div> 


</div><!-- /page -->

</body>
</html>
