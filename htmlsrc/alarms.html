<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>流水线管理系统</title>
	<link rel="shortcut icon" href="./favicon.ico">
   <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,700">  -->
	<link rel="stylesheet" href="./jmobile/demos/css/themes/default/jquery.mobile-1.4.5.min.css">
	<link rel="stylesheet" href="./jmobile/demos/_assets/css/jqm-demos.css">
	<script src="./js/jquery-1.11.2.min.js"></script>
	<script src="./jmobile/demos/_assets/js/index.js"></script>
	<script src="./js/jquery.mobile-1.4.5.min.js"></script>
	<script type="text/javascript">
	   
	    function GetJsonAlarms(){
		     
		    alarmlistlineorig = '<div data-role="collapsible" data-collapsed="true"  ><h2>{{workshop}}  {{StartTime}}</h2>  \
	   <ul>  <li> 站号:{{stationid}}</li>	<li>制程:{{linetype}}</li>	<li>设备号: {{machineid}} </li> \
	               <li>异常信息代码:{{exception}}</li><li>	异常信息描述:{{errortxt}}	</li> \
		           <li>发生时间:{{StartTime}}  </li>  \
	               </ul>  \
	               </div>' ;
			alarmstrs="";
	        $.getJSON("/alarm?stationid=1",null,function(data){ 
 
		        $.each(data,function(idx,item){ 
				     alarmlistline = alarmlistlineorig;
				     alarmlistline = alarmlistline.replace(/{{workshop}}/g,item.Workshop);
					 alarmlistline = alarmlistline.replace(/{{StartTime}}/g,item.StartTime);
					 alarmlistline = alarmlistline.replace(/{{stationid}}/g,item.StationID);
					 alarmlistline = alarmlistline.replace(/{{linetype}}/g,item.StationType);
					 alarmlistline = alarmlistline.replace(/{{machineid}}/g,item.MachineID);
					 alarmlistline = alarmlistline.replace(/{{exception}}/g,item.AlarmCode);
					 alarmlistline = alarmlistline.replace(/{{errortxt}}/g,item.AlarmDescription);
					 
					 alarmstrs = alarmstrs + alarmlistline;
		        }); 
				 
				 //console.log(alarmstrs);
				 $("#alarmlists").html(alarmstrs);
				 
				  $('#alarmlists').trigger("create");
				 
		    }); 
			
			
 
        }
	 	$(document).ready(function (){
		
		     GetJsonAlarms();	
		
		      //console.log( $("#alarmlists").html());
		     
		});
		 
		
		
	  
	  </script>
</head>
<body>
<div data-role="page" class="jqm-demos" data-quicklinks="true">

	<div data-role="header" data-position="fixed" >
	 <h1>流水线管理系统</h1>
	 <div data-role="navbar">
	    <ul>
		<li><a rel="external" href="/src/index.html" >设备状态</a></li>
		<li><a rel="external" href="/src/devinfo.html" >设备详情</a></li>
		<li><a href="#index" >统计图表</a></li>
		<li><a  rel="external" href="/src/alarms.html" >活动告警</a></li>
		</ul>
	 </div>
	</div><!-- /header -->

	<div data-role="content"   >
	   <div data-role="collapsible-set"  id="alarmlists">  
	   <div data-role="collapsible" data-collapsed="true">
	   <h2>{第01号车间  2015/1/14 4:42:23</h2>
	   <ul>  <li> 站号:1	制程:内层前处理线	设备号: 2
	     <li>异常信息代码:34	异常信息描述:ul34	
		 <li>发生时间:2015/1/13 4:42:23
	       
	   
	   </ul>
	   </div>
	   <div data-role="collapsible" data-collapsed="true">
	   <h2>{第02号车间 2015/1/14 4:42:23</h2>
	   <ul>
	        <li> 站号:1	制程:外层前处理线	设备号: 2
	     <li>异常信息代码:35	异常信息描述:ul35	
		 <li>发生时间:2015/1/14 4:42:23
	       
	   
	   </ul>
	   </div>
	    <div data-role="collapsible" data-collapsed="false">
	   <h2>{第03号车间 2015/1/14 4:42:23</h2>
	   <ul>
	        <li> 站号:1	制程:外层前处理线	设备号: 2
	     <li>异常信息代码:35	异常信息描述:ul35	
		 <li>发生时间:2015/1/14 4:42:23
	       
	   
	   </ul>
	   </div>
	   
	   
	   </div>
	</div> 
	<div data-role="footer"  >
	   <div data-role="navbar">
	    <ul>
		<li><a rel="external" href="/src/index.html" >设备状态</a></li>
		<li><a rel="external" href="/src/devinfo.html" >设备详情</a></li>
		<li><a href="#index" >统计图表</a></li>
		<li><a  rel="external" href="/src/alarms.html" >活动告警</a></li>
		</ul>
	 </div>
	</div> 


</div><!-- /page -->

</body>
</html>
